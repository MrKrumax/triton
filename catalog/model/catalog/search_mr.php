<?php
class ModelCatalogSearchMr extends Model{private $aa436834306af60fb7a79f5a199b676b9=3;public function getProducts($a58c6c30de29fe154b64ec7afad7f0127=array()){$this->load->model('catalog/product');$this->load->model('tool/morphy');$a16276e44610d32dd4d4870b08b899218=isset($a58c6c30de29fe154b64ec7afad7f0127['search_mr_options'])?$a58c6c30de29fe154b64ec7afad7f0127['search_mr_options']:array();if($this->customer->isLogged()){$a1fe61ad4be625872a3fa773430486d58=$this->customer->getCustomerGroupId();}else{$a1fe61ad4be625872a3fa773430486d58=$this->config->get('config_customer_group_id');}$aa20acd108f70e3d3d69439c8cd4034dd=md5(http_build_query($a58c6c30de29fe154b64ec7afad7f0127+$a16276e44610d32dd4d4870b08b899218));$a1781f5e108ca15ba9296c3747968aeca=$this->cache->get('search.'.(int)$this->config->get('config_language_id').'.'.(int)$this->config->get('config_store_id').'.'.(int)$a1fe61ad4be625872a3fa773430486d58.'.'.$aa20acd108f70e3d3d69439c8cd4034dd);if(!$a1781f5e108ca15ba9296c3747968aeca){$a6703f7a1694f24769636697b72220aed=" p.product_id ";if(isset($a58c6c30de29fe154b64ec7afad7f0127['sort'])&&$a58c6c30de29fe154b64ec7afad7f0127['sort']=="rating"){$a6703f7a1694f24769636697b72220aed.=", (SELECT AVG(rating) AS total FROM ".DB_PREFIX."review r1 WHERE r1.product_id = p.product_id AND r1.status = '1' GROUP BY r1.product_id) AS rating ";}$a6703f7a1694f24769636697b72220aed.=" FROM ".DB_PREFIX."product p LEFT JOIN ".DB_PREFIX."product_description pd ON (p.product_id = pd.product_id) LEFT JOIN ".DB_PREFIX."product_to_store p2s ON (p.product_id = p2s.product_id)";if(!empty($a58c6c30de29fe154b64ec7afad7f0127['filter_category_id'])){$a6703f7a1694f24769636697b72220aed.=" LEFT JOIN ".DB_PREFIX."product_to_category p2c ON (p.product_id = p2c.product_id)";}if(isset($a16276e44610d32dd4d4870b08b899218['fields']['attributes']['search'])&&$a16276e44610d32dd4d4870b08b899218['fields']['attributes']['search']){$a6703f7a1694f24769636697b72220aed.=" LEFT JOIN ".DB_PREFIX."product_attribute pa ON (p.product_id = pa.product_id)";}$a6703f7a1694f24769636697b72220aed.=" WHERE pd.language_id = '".(int)$this->config->get('config_language_id')."' AND p.status = '1' AND p.date_available <= NOW() AND p2s.store_id = '".(int)$this->config->get('config_store_id')."'";if(!empty($a58c6c30de29fe154b64ec7afad7f0127['filter_name'])){$af2e6e38a7dd1baf5bcd67e48c00edc13=$this->getFields();if(!empty($a58c6c30de29fe154b64ec7afad7f0127['filter_description'])&&(!isset($a16276e44610d32dd4d4870b08b899218['fields']['description']['search'])||!$a16276e44610d32dd4d4870b08b899218['fields']['description']['search'])){$a16276e44610d32dd4d4870b08b899218['fields']['description']['search']='contains';}$a5305bcce00dac5d96e5dfd817a6c6200=explode(' ',trim(preg_replace('/\s\s+/',' ',$a58c6c30de29fe154b64ec7afad7f0127['filter_name'])));foreach($a5305bcce00dac5d96e5dfd817a6c6200 as $a247bae1b1e754662f393de04516ef6c9=>$a46ea38c17fdc02355d6cee043e63f7c5){if(strlen($a46ea38c17fdc02355d6cee043e63f7c5)<$this->min_word_lenght){unset($a5305bcce00dac5d96e5dfd817a6c6200[$a247bae1b1e754662f393de04516ef6c9]);}}$aa3dc5f73bba178a95b1c1d88967644c1=$this->model_tool_morphy->getRoots($a5305bcce00dac5d96e5dfd817a6c6200);$aa31841796bb7e893211dfece87abf4aa=array();$a76a83447b981d6e8d4ce05f29a895e54=array();foreach($af2e6e38a7dd1baf5bcd67e48c00edc13 as $af428ba6e0aafe4089166bfdaef665619=>$a347a2b10ef9950e89be03364691234d2){if(isset($a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['search'])&&$a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['search']){$a6c3f64dd54cac3335ec837ffb51880bb=array($a58c6c30de29fe154b64ec7afad7f0127['filter_name']);if(isset($a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['phrase'])&&$a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['phrase']=='cut'){$a6c3f64dd54cac3335ec837ffb51880bb=$a5305bcce00dac5d96e5dfd817a6c6200;}if(isset($a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['use_morphology'])&&$a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['use_morphology']){$a6c3f64dd54cac3335ec837ffb51880bb=$aa3dc5f73bba178a95b1c1d88967644c1;}$abff83e62b654db1a8b84fd993192ca87=$a6cfb24f4bffacf62795552cb9d9f9938=$a7e0d77661174a8c942980b395973aa66=0;if(isset($a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['use_relevance'])&&$a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['use_relevance']){$abff83e62b654db1a8b84fd993192ca87=isset($a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['relevance']['start'])?(int)$a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['relevance']['start']:0;$a6cfb24f4bffacf62795552cb9d9f9938=isset($a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['relevance']['phrase'])?(int)$a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['relevance']['phrase']:0;$a7e0d77661174a8c942980b395973aa66=isset($a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['relevance']['word'])?(int)$a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['relevance']['word']:0;$a7e0d77661174a8c942980b395973aa66=round(($a7e0d77661174a8c942980b395973aa66/count($a6c3f64dd54cac3335ec837ffb51880bb)),2);if($a6cfb24f4bffacf62795552cb9d9f9938){$aa31841796bb7e893211dfece87abf4aa[]="IF (LCASE(".$a347a2b10ef9950e89be03364691234d2.") LIKE '%".$this->db->escape(utf8_strtolower($a58c6c30de29fe154b64ec7afad7f0127['filter_name']))."%', ".$a6cfb24f4bffacf62795552cb9d9f9938.", 0)";}}foreach($a6c3f64dd54cac3335ec837ffb51880bb as $a46ea38c17fdc02355d6cee043e63f7c5){$a9589140294a5e03e6a16e1c110fa3c5d='';switch($a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['search']){case  'equally':$a9589140294a5e03e6a16e1c110fa3c5d="LCASE(".$a347a2b10ef9950e89be03364691234d2.") = '".$this->db->escape(utf8_strtolower($a46ea38c17fdc02355d6cee043e63f7c5))."'";break;case  'contains':$a9589140294a5e03e6a16e1c110fa3c5d="LCASE(".$a347a2b10ef9950e89be03364691234d2.") LIKE '%".$this->db->escape(utf8_strtolower($a46ea38c17fdc02355d6cee043e63f7c5))."%'";break;case  'start':default:$a9589140294a5e03e6a16e1c110fa3c5d="LCASE(".$a347a2b10ef9950e89be03364691234d2.") LIKE '".$this->db->escape(utf8_strtolower($a46ea38c17fdc02355d6cee043e63f7c5))."%'";}if($af428ba6e0aafe4089166bfdaef665619=='attributes'){$a9589140294a5e03e6a16e1c110fa3c5d.=" AND pa.language_id = '".(int)$this->config->get('config_language_id')."' ";}$a76a83447b981d6e8d4ce05f29a895e54[]=' ('.$a9589140294a5e03e6a16e1c110fa3c5d.') ';if($abff83e62b654db1a8b84fd993192ca87){$aa31841796bb7e893211dfece87abf4aa[]="IF (LCASE(".$a347a2b10ef9950e89be03364691234d2.") LIKE '".$this->db->escape(utf8_strtolower($a46ea38c17fdc02355d6cee043e63f7c5))."%', ".$abff83e62b654db1a8b84fd993192ca87.", 0)";}if($a7e0d77661174a8c942980b395973aa66){$aa31841796bb7e893211dfece87abf4aa[]="IF (LCASE(".$a347a2b10ef9950e89be03364691234d2.") LIKE '%".$this->db->escape(utf8_strtolower($a46ea38c17fdc02355d6cee043e63f7c5))."%', ".$a7e0d77661174a8c942980b395973aa66.", 0)";}}}}if($a76a83447b981d6e8d4ce05f29a895e54){$a6703f7a1694f24769636697b72220aed.="  AND ( ".implode(" OR ",$a76a83447b981d6e8d4ce05f29a895e54)." ) ";}if(!empty($a58c6c30de29fe154b64ec7afad7f0127['filter_category_id'])){if(!empty($a58c6c30de29fe154b64ec7afad7f0127['filter_sub_category'])){$a0ef370d2a713f28b73e5b618b35cb5af=array();$a0ef370d2a713f28b73e5b618b35cb5af[]="p2c.category_id = '".(int)$a58c6c30de29fe154b64ec7afad7f0127['filter_category_id']."'";$this->load->model('catalog/category');$a420497a063625085027757038df2cd6f=$this->model_catalog_category->getCategoriesByParentId($a58c6c30de29fe154b64ec7afad7f0127['filter_category_id']);foreach($a420497a063625085027757038df2cd6f as $a22cce6d870512d3998735b49fde45eb0){$a0ef370d2a713f28b73e5b618b35cb5af[]="p2c.category_id = '".(int)$a22cce6d870512d3998735b49fde45eb0."'";}$a6703f7a1694f24769636697b72220aed.=" AND (".implode(' OR ',$a0ef370d2a713f28b73e5b618b35cb5af).")";}else{$a6703f7a1694f24769636697b72220aed.=" AND p2c.category_id = '".(int)$a58c6c30de29fe154b64ec7afad7f0127['filter_category_id']."'";}}if(!empty($a58c6c30de29fe154b64ec7afad7f0127['filter_manufacturer_id'])){$a6703f7a1694f24769636697b72220aed.=" AND p.manufacturer_id = '".(int)$a58c6c30de29fe154b64ec7afad7f0127['filter_manufacturer_id']."'";}}$a6703f7a1694f24769636697b72220aed.=" GROUP BY p.product_id";$aceb8a118d895f27926c6eea23d2a238e=array('pd.name','p.model','p.quantity','p.price','rating','p.sort_order','p.date_added','relevance');if($aa31841796bb7e893211dfece87abf4aa&&(!isset($a58c6c30de29fe154b64ec7afad7f0127['sort'])||(isset($a58c6c30de29fe154b64ec7afad7f0127['sort'])&&$a58c6c30de29fe154b64ec7afad7f0127['sort']=='p.sort_order'))){$a58c6c30de29fe154b64ec7afad7f0127['sort']='relevance';$a58c6c30de29fe154b64ec7afad7f0127['order']='DESC';}if(isset($a58c6c30de29fe154b64ec7afad7f0127['sort'])&&in_array($a58c6c30de29fe154b64ec7afad7f0127['sort'],$aceb8a118d895f27926c6eea23d2a238e)){if($a58c6c30de29fe154b64ec7afad7f0127['sort']=='pd.name'||$a58c6c30de29fe154b64ec7afad7f0127['sort']=='p.model'){$a6703f7a1694f24769636697b72220aed.=" ORDER BY LCASE(".$a58c6c30de29fe154b64ec7afad7f0127['sort'].")";}else{$a6703f7a1694f24769636697b72220aed.=" ORDER BY ".$a58c6c30de29fe154b64ec7afad7f0127['sort'];}}else{$a6703f7a1694f24769636697b72220aed.=" ORDER BY p.sort_order";}if(isset($a58c6c30de29fe154b64ec7afad7f0127['order'])&&($a58c6c30de29fe154b64ec7afad7f0127['order']=='DESC')){$a6703f7a1694f24769636697b72220aed.=" DESC, LCASE(pd.name) ASC";}else{$a6703f7a1694f24769636697b72220aed.=" ASC, LCASE(pd.name) ASC";}if(isset($a58c6c30de29fe154b64ec7afad7f0127['start'])||isset($a58c6c30de29fe154b64ec7afad7f0127['limit'])){if($a58c6c30de29fe154b64ec7afad7f0127['start']<0){$a58c6c30de29fe154b64ec7afad7f0127['start']=0;}if($a58c6c30de29fe154b64ec7afad7f0127['limit']<1){$a58c6c30de29fe154b64ec7afad7f0127['limit']=20;}$a6703f7a1694f24769636697b72220aed.=" LIMIT ".(int)$a58c6c30de29fe154b64ec7afad7f0127['start'].",".(int)$a58c6c30de29fe154b64ec7afad7f0127['limit'];}if(isset($a58c6c30de29fe154b64ec7afad7f0127['sort'])&&$a58c6c30de29fe154b64ec7afad7f0127['sort']=='relevance'&&$aa31841796bb7e893211dfece87abf4aa){$aa31841796bb7e893211dfece87abf4aa=" (".implode(" + ",$aa31841796bb7e893211dfece87abf4aa).") AS relevance, ";}else{$aa31841796bb7e893211dfece87abf4aa="";}$a6703f7a1694f24769636697b72220aed="SELECT ".$aa31841796bb7e893211dfece87abf4aa.$a6703f7a1694f24769636697b72220aed;$a1781f5e108ca15ba9296c3747968aeca=array();$ae28fff5e242af1a289f72aa784802344=$this->db->query($a6703f7a1694f24769636697b72220aed);foreach($ae28fff5e242af1a289f72aa784802344->rows as $a84984198520189a49d492dfd7f5278db){$a1781f5e108ca15ba9296c3747968aeca[$a84984198520189a49d492dfd7f5278db['product_id']]=$this->model_catalog_product->getProduct($a84984198520189a49d492dfd7f5278db['product_id']);}$this->cache->set('search.'.(int)$this->config->get('config_language_id').'.'.(int)$this->config->get('config_store_id').'.'.(int)$a1fe61ad4be625872a3fa773430486d58.'.'.$aa20acd108f70e3d3d69439c8cd4034dd,$a1781f5e108ca15ba9296c3747968aeca);}return $a1781f5e108ca15ba9296c3747968aeca;}public function getTotalProducts($a58c6c30de29fe154b64ec7afad7f0127=array()){$this->load->model('tool/morphy');$a16276e44610d32dd4d4870b08b899218=isset($a58c6c30de29fe154b64ec7afad7f0127['search_mr_options'])?$a58c6c30de29fe154b64ec7afad7f0127['search_mr_options']:array();if($this->customer->isLogged()){$a1fe61ad4be625872a3fa773430486d58=$this->customer->getCustomerGroupId();}else{$a1fe61ad4be625872a3fa773430486d58=$this->config->get('config_customer_group_id');}$aa20acd108f70e3d3d69439c8cd4034dd=md5(http_build_query($a58c6c30de29fe154b64ec7afad7f0127+$a16276e44610d32dd4d4870b08b899218));$a1781f5e108ca15ba9296c3747968aeca=$this->cache->get('search.total.'.(int)$this->config->get('config_language_id').'.'.(int)$this->config->get('config_store_id').'.'.(int)$a1fe61ad4be625872a3fa773430486d58.'.'.$aa20acd108f70e3d3d69439c8cd4034dd);if(!$a1781f5e108ca15ba9296c3747968aeca){$a6703f7a1694f24769636697b72220aed="SELECT COUNT(DISTINCT p.product_id) AS total FROM ".DB_PREFIX."product p LEFT JOIN ".DB_PREFIX."product_description pd ON (p.product_id = pd.product_id) LEFT JOIN ".DB_PREFIX."product_to_store p2s ON (p.product_id = p2s.product_id)";if(!empty($a58c6c30de29fe154b64ec7afad7f0127['filter_category_id'])){$a6703f7a1694f24769636697b72220aed.=" LEFT JOIN ".DB_PREFIX."product_to_category p2c ON (p.product_id = p2c.product_id)";}if(isset($a16276e44610d32dd4d4870b08b899218['fields']['attributes']['search'])&&$a16276e44610d32dd4d4870b08b899218['fields']['attributes']['search']){$a6703f7a1694f24769636697b72220aed.=" LEFT JOIN ".DB_PREFIX."product_attribute pa ON (p.product_id = pa.product_id)";}$a6703f7a1694f24769636697b72220aed.=" WHERE pd.language_id = '".(int)$this->config->get('config_language_id')."' AND p.status = '1' AND p.date_available <= NOW() AND p2s.store_id = '".(int)$this->config->get('config_store_id')."'";if(!empty($a58c6c30de29fe154b64ec7afad7f0127['filter_name'])){$af2e6e38a7dd1baf5bcd67e48c00edc13=$this->getFields();if(!empty($a58c6c30de29fe154b64ec7afad7f0127['filter_description'])&&(!isset($a16276e44610d32dd4d4870b08b899218['fields']['description']['search'])||!$a16276e44610d32dd4d4870b08b899218['fields']['description']['search'])){$a16276e44610d32dd4d4870b08b899218['fields']['description']['search']='contains';}$a5305bcce00dac5d96e5dfd817a6c6200=explode(' ',trim(preg_replace('/\s\s+/',' ',$a58c6c30de29fe154b64ec7afad7f0127['filter_name'])));foreach($a5305bcce00dac5d96e5dfd817a6c6200 as $a247bae1b1e754662f393de04516ef6c9=>$a46ea38c17fdc02355d6cee043e63f7c5){if(strlen($a46ea38c17fdc02355d6cee043e63f7c5)<$this->min_word_lenght){unset($a5305bcce00dac5d96e5dfd817a6c6200[$a247bae1b1e754662f393de04516ef6c9]);}}$aa3dc5f73bba178a95b1c1d88967644c1=$this->model_tool_morphy->getRoots($a5305bcce00dac5d96e5dfd817a6c6200);$aa31841796bb7e893211dfece87abf4aa=array();$a76a83447b981d6e8d4ce05f29a895e54=array();foreach($af2e6e38a7dd1baf5bcd67e48c00edc13 as $af428ba6e0aafe4089166bfdaef665619=>$a347a2b10ef9950e89be03364691234d2){if(isset($a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['search'])&&$a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['search']){$a6c3f64dd54cac3335ec837ffb51880bb=array($a58c6c30de29fe154b64ec7afad7f0127['filter_name']);if(isset($a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['phrase'])&&$a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['phrase']=='cut'){$a6c3f64dd54cac3335ec837ffb51880bb=$a5305bcce00dac5d96e5dfd817a6c6200;}if(isset($a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['use_morphology'])&&$a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['use_morphology']){$a6c3f64dd54cac3335ec837ffb51880bb=$aa3dc5f73bba178a95b1c1d88967644c1;}$abff83e62b654db1a8b84fd993192ca87=$a6cfb24f4bffacf62795552cb9d9f9938=$a7e0d77661174a8c942980b395973aa66=0;if(isset($a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['use_relevance'])&&$a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['use_relevance']){$abff83e62b654db1a8b84fd993192ca87=isset($a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['relevance']['start'])?(int)$a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['relevance']['start']:0;$a6cfb24f4bffacf62795552cb9d9f9938=isset($a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['relevance']['phrase'])?(int)$a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['relevance']['phrase']:0;$a7e0d77661174a8c942980b395973aa66=isset($a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['relevance']['word'])?(int)$a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['relevance']['word']:0;$a7e0d77661174a8c942980b395973aa66=round(($a7e0d77661174a8c942980b395973aa66/count($a6c3f64dd54cac3335ec837ffb51880bb)),2);if($a6cfb24f4bffacf62795552cb9d9f9938){$aa31841796bb7e893211dfece87abf4aa[]="IF (LCASE(".$a347a2b10ef9950e89be03364691234d2.") LIKE '%".$this->db->escape(utf8_strtolower($a58c6c30de29fe154b64ec7afad7f0127['filter_name']))."%', ".$a6cfb24f4bffacf62795552cb9d9f9938.", 0)";}}foreach($a6c3f64dd54cac3335ec837ffb51880bb as $a46ea38c17fdc02355d6cee043e63f7c5){$a9589140294a5e03e6a16e1c110fa3c5d='';switch($a16276e44610d32dd4d4870b08b899218['fields'][$af428ba6e0aafe4089166bfdaef665619]['search']){case  'equally':$a9589140294a5e03e6a16e1c110fa3c5d="LCASE(".$a347a2b10ef9950e89be03364691234d2.") = '".$this->db->escape(utf8_strtolower($a46ea38c17fdc02355d6cee043e63f7c5))."'";break;case  'contains':$a9589140294a5e03e6a16e1c110fa3c5d="LCASE(".$a347a2b10ef9950e89be03364691234d2.") LIKE '%".$this->db->escape(utf8_strtolower($a46ea38c17fdc02355d6cee043e63f7c5))."%'";break;case  'start':default:$a9589140294a5e03e6a16e1c110fa3c5d="LCASE(".$a347a2b10ef9950e89be03364691234d2.") LIKE '".$this->db->escape(utf8_strtolower($a46ea38c17fdc02355d6cee043e63f7c5))."%'";}if($af428ba6e0aafe4089166bfdaef665619=='attributes'){$a9589140294a5e03e6a16e1c110fa3c5d.=" AND pa.language_id = '".(int)$this->config->get('config_language_id')."' ";}$a76a83447b981d6e8d4ce05f29a895e54[]=' ('.$a9589140294a5e03e6a16e1c110fa3c5d.') ';if($abff83e62b654db1a8b84fd993192ca87){$aa31841796bb7e893211dfece87abf4aa[]="IF (LCASE(".$a347a2b10ef9950e89be03364691234d2.") LIKE '".$this->db->escape(utf8_strtolower($a46ea38c17fdc02355d6cee043e63f7c5))."%', ".$abff83e62b654db1a8b84fd993192ca87.", 0)";}if($a7e0d77661174a8c942980b395973aa66){$aa31841796bb7e893211dfece87abf4aa[]="IF (LCASE(".$a347a2b10ef9950e89be03364691234d2.") LIKE '%".$this->db->escape(utf8_strtolower($a46ea38c17fdc02355d6cee043e63f7c5))."%', ".$a7e0d77661174a8c942980b395973aa66.", 0)";}}}}if($a76a83447b981d6e8d4ce05f29a895e54){$a6703f7a1694f24769636697b72220aed.="  AND ( ".implode(" OR ",$a76a83447b981d6e8d4ce05f29a895e54)." ) ";}if(!empty($a58c6c30de29fe154b64ec7afad7f0127['filter_category_id'])){if(!empty($a58c6c30de29fe154b64ec7afad7f0127['filter_sub_category'])){$a0ef370d2a713f28b73e5b618b35cb5af=array();$a0ef370d2a713f28b73e5b618b35cb5af[]="p2c.category_id = '".(int)$a58c6c30de29fe154b64ec7afad7f0127['filter_category_id']."'";$this->load->model('catalog/category');$a420497a063625085027757038df2cd6f=$this->model_catalog_category->getCategoriesByParentId($a58c6c30de29fe154b64ec7afad7f0127['filter_category_id']);foreach($a420497a063625085027757038df2cd6f as $a22cce6d870512d3998735b49fde45eb0){$a0ef370d2a713f28b73e5b618b35cb5af[]="p2c.category_id = '".(int)$a22cce6d870512d3998735b49fde45eb0."'";}$a6703f7a1694f24769636697b72220aed.=" AND (".implode(' OR ',$a0ef370d2a713f28b73e5b618b35cb5af).")";}else{$a6703f7a1694f24769636697b72220aed.=" AND p2c.category_id = '".(int)$a58c6c30de29fe154b64ec7afad7f0127['filter_category_id']."'";}}if(!empty($a58c6c30de29fe154b64ec7afad7f0127['filter_manufacturer_id'])){$a6703f7a1694f24769636697b72220aed.=" AND p.manufacturer_id = '".(int)$a58c6c30de29fe154b64ec7afad7f0127['filter_manufacturer_id']."'";}}$ae28fff5e242af1a289f72aa784802344=$this->db->query($a6703f7a1694f24769636697b72220aed);$this->cache->set('search.total.'.(int)$this->config->get('config_language_id').'.'.(int)$this->config->get('config_store_id').'.'.(int)$a1fe61ad4be625872a3fa773430486d58.'.'.$aa20acd108f70e3d3d69439c8cd4034dd,$a1781f5e108ca15ba9296c3747968aeca);}return $ae28fff5e242af1a289f72aa784802344->row['total'];}private function getFields(){return array('name'=>'pd.name','description'=>'pd.description','tags'=>'pd.tag','attributes'=>'pa.text','model'=>'p.model','sku'=>'p.sku','upc'=>'p.upc','ean'=>'p.ean','jan'=>'p.jan','isbn'=>'p.isbn','mpn'=>'p.mpn');}}
//author sv2109 (sv2109@gmail.com) license for 1 product copy granted for GReG0 (hicenko@gmail.com)
